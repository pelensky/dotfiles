# ==============================================================================
# BASIC SETTINGS
# ==============================================================================

set-option -g default-shell /bin/zsh
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
set -g history-limit 102400
set -s escape-time 0
set -g base-index 1
set-window-option -g pane-base-index 1
set -g renumber-windows on
set-option -g allow-rename off
set-window-option -g automatic-rename
set -g focus-events on
set -g mouse on
setw -g aggressive-resize off

# ==============================================================================
# PREFIX KEY
# ==============================================================================

# Change prefix from C-b to C-a (like screen)
unbind C-b
set -g prefix C-a
bind-key C-a last-window
bind a send-prefix
bind ^a last-window

# ==============================================================================
# VI MODE
# ==============================================================================

setw -g mode-keys vi
set-option -g status-keys emacs

# ==============================================================================
# WINDOW AND PANE MANAGEMENT
# ==============================================================================

# Split windows (like vim, using current directory)
bind s split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"
bind b split-window
bind c new-window -c "#{pane_current_path}"

# Navigate panes (vim-style with hjkl)
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Resize panes (vim-style)
bind < resize-pane -L 5
bind > resize-pane -R 5
bind - resize-pane -D 5
bind + resize-pane -U 5

# Reorder windows
bind-key -n C-S-h swap-window -t -1
bind-key -n C-S-l swap-window -t +1

# ==============================================================================
# SESSION MANAGEMENT
# ==============================================================================

bind C new-session
bind L choose-session
bind K confirm kill-server
bind X confirm kill-window
unbind d

# ==============================================================================
# KEYBINDINGS
# ==============================================================================

bind : command-prompt
bind r source-file ~/.tmux.conf \; display-message "Config reloaded..."

# ==============================================================================
# COPY AND PASTE
# ==============================================================================

setw -g mode-keys vi
bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
bind-key -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"

# ==============================================================================
# STATUS BAR
# ==============================================================================

set -g status-interval 1
set -g status-justify left
set-option -g status-right-length 100
set -g status-right-style ''

# Nova color scheme
set -g status-style 'bg=#1E272C,fg=#6A7D89'
set -g window-status-current-style 'fg=cyan'
set -g mode-style 'bg=cyan,fg=black'
set -g message-style 'bg=black,fg=cyan'
set -g pane-border-style 'bg=black,fg=#1E272C'
set -g pane-active-border-style 'bg=black,fg=#1E272C'

# Status bar right
set-option -g status-right '#[bg=colour239]#[fg=colour195] #S â€¢ #[bg=colour239]#[fg=colour107] #(date "+%a %d %b %y %H:%M")'

# Window status
set-window-option -g window-status-format '#[bg=colour238]#[fg=colour107] #I #[bg=colour239]#[fg=colour110] #[bg=colour240]#W#[bg=colour239]#[fg=colour195]#F#[bg=colour238] '
set-window-option -g window-status-current-format '#[bg=colour236]#[fg=colour215] #I #[bg=colour235]#[fg=colour167] #[bg=colour234]#W#[bg=colour235]#[fg=colour195]#F#[bg=colour236] '
set-window-option -g window-status-style fg=colour244,bg=default

# Pane display
set-option -g display-panes-active-colour colour33
set-option -g display-panes-colour colour166

# Clock
set-window-option -g clock-mode-colour green

# ==============================================================================
# PLUGINS
# ==============================================================================

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin "jlipps/tmux-safekill"
set -g @plugin "graemedavidson/tmux-pane-focus"

# Plugin configuration
set -g @pane-focus-size '80'
set -g @pane-focus-direction '+'
set -g @pane-focus-enabled 'on'

# Initialize TPM (keep this line at the very bottom)
run '~/.tmux/plugins/tpm/tpm'
